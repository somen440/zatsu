name: PR Comment hook

on:
  issue_comment:
    types: [created]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Dump GitHub context
      id: trigger
#      env:
#        GITHUB_CONTEXT: ${{ toJson(github) }}
      run: |
        echo ::set-output name=cmd::${{ github.event.comment.body }}
        echo ::set-output name=pr_url::${{ github.event.issue.pull_request.url }}

    - name: Check output
      if: steps.trigger.outputs.cmd == 'deploy'
      run: |
        echo cmd is deploy
        pr_branch=`curl https://api.github.com/repos/somen440/zatsu/pulls/5 | jq '.head.ref'
        for file in `git diff --name-only origin/master origin/${pr_branch}`
        do
          echo file is $file
        done
